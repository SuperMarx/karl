select product.identifier, productdetails.name, productdetails.orig_price, productdetails.price, productdetails.discount_amount, productdetails.valid_on, productdetails.retrieved_on from product inner join productdetails on (product.id = productdetails.product_id) where lower(productdetails.name) like lower($1) AND productdetails.valid_until is NULL AND product.supermarket_id = $2
